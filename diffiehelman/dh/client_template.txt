"""DH kex client.

By:
Group 24: Prince Samuel Kyeremanteng and Hadar Eklund
"""

import os


def _import_helpers():
    try:
        from diffiehelman.dh.dh_client import dh_handshake_and_decrypt
        return dh_handshake_and_decrypt
    except ImportError:
        import sys
        from pathlib import Path

        repo_root = Path(__file__).resolve().parents[2]
        sys.path.insert(0, str(repo_root))
        from diffiehelman.dh.dh_client import dh_handshake_and_decrypt
        return dh_handshake_and_decrypt


if __name__ == '__main__':
    """python client.py"""
    # host = os.environ.get("DH_HOST", "127.0.0.1")
    host = os.environ.get("DH_HOST", "igor.eit.lth.se")
    port = int(os.environ.get("DH_PORT", "6004"))

    dh_handshake_and_decrypt = _import_helpers()
    plaintext, _key = dh_handshake_and_decrypt(host, port)
    print(plaintext)
